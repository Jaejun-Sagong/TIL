### **쿠키/세션 사용하는 이유?**

> HTTP 프로토콜의 특징이자 약점을 보완하기 위해서 사용한다.
> 

**HTTP 프로토콜**

```
네트워크 상에서 통신을 하기 위한 

규약 혹은 규칙 같은 것이다.
```

### **HTTP 프로토콜의 특징 및 약점**

1. **Connectionless 프로토콜 (비연결 지향)**

> Request, Response를 주고받은 후 **연결을 끊는 처리 방식**
> 

![image](https://user-images.githubusercontent.com/109019062/214561871-f25b2690-34b2-4192-be28-8e630358b865.png)

**2. Stateless 프로토콜**

> 연결을 끊는 순간 **상태 정보는 유지하지 않는 특성**
> 

클라이언트와 첫 번째 통신에서 데이터를 주고받았다 해도, **두 번째 통신**에서 **이전 데이터를 유지하지 않는다.**

ex)매번 페이지를 이동할 때마다 다시 로그인 번거로움

**→쿠키/세션/캐시 의 필요성**

---

## **쿠키(Cookie)**

사용자가 어떠한 웹 사이트를 방문할 경우,

서버에서 **클라이언트에 저장하는,** 

**[Key : Value]가 담긴 작은 데이터 파일**이다.

![image](https://user-images.githubusercontent.com/109019062/214561944-14692275-1515-4bc4-b350-16e64db0a244.png)

- **쿠키 특징**
    1. 이름, 값, 만료일(저장기간), 경로 정보로 구성되어 있다.
    2. 클라이언트에 총 300개의 쿠키를 저장할 수 있다.
    3. 하나의 도메인 당 20개의 쿠키를 가질 수 있다.
    4. 하나의 쿠키는 4KB(=4096byte)까지 저장 가능하다.
    5. 쿠키는 클라이언트의 상태 정보를 **’로컬’에 저장했다가** 
        
        Request 시 **자동으로 쿠키를 포함해서** 서버로 보낸다는 것입니다.
        

- **쿠키의 동작 순서**
    1. 클라이언트가 서버에 페이지를 요청한다. (사용자가 웹사이트에 접근)
    2. 웹 서버는 쿠키를 생성한다.
    3. 생성한 쿠키에 정보를 담아 HTTP 화면을 돌려줄 때 헤더에 실어 같이 클라이언트에게 돌려준다.
    4. 클라이언트는 넘겨받은 쿠키를 로컬 PC에 저장하고 **다시** **서버에 요청할 때마다 쿠키를  함께 전송해서 빠르게 응답을 받는다.**
- **사용 예시**
    1. 로그인 시, "아이디와 비밀번호를 저장하시겠습니까?"
    2. "오늘 이 창을 다시 보지 않기"

---

## **세션(Session)**

쿠키를 기반으로 하고 있지만 사용자 정보 파일을 ‘**서버’ 측에서 저장하고 관리**

(쿠키 사용)

![image](https://user-images.githubusercontent.com/109019062/214562051-427b8072-d44e-418a-814c-9efaab655bd2.png)

- **세션 특징**
    1.  세션ID와 클라이언트 정보를 **서버**에 **저장**
    2. 클라이언트 구분 용도로 **세션 ID**를 부여하며 웹 브라우저가 서버에 접속해서 브라우저를 종료할 때까지 **인증상태를 유지**합니다. 
    3. 브라우저를 닫거나, 서버에서 세션을 삭제했을 때만 삭제
        
        사용자의 중요한 정보는 서버에 저장.
        
        →쿠키보다 비교적 **보안이 좋다.**
        
    4. 저장 데이터에 제한이 없다. (서버 용량이 허용하는 한에서)
- **세션의 동작 순서**
    1. 클라이언트가 서버에 요청 시 **HTTP 헤더에 세션 ID 실어** 응답. 
        
        (Set-Cookie: JSESSIONID=xslei13f)(쿠키에 담아서 응답)
        
    2. 클라이언트는 세션 ID에 대해 쿠키를 사용해서 저장하고 가지고 있음
    3. 클라이언트는 서버에 요청할 때, 이 쿠키의 세션 ID를 같이 서버에 전달해서 요청
    4. 서버는 세션 ID를 전달 받아서 별다른 작업 없이 세션ID로 구분해서 클라언트 정보를 가져와서 요청에 따른 응답
- **사용 예시**
    - 화면을 이동해도 로그인이 풀리지 않고 로그아웃하기 전까지 유지

---

**쿠키와 세션의 차이**

- 큰 차이점은 **사용자의 정보가 저장되는 위치**이다. (서버 자원의 사용 유무)
- **보안성 ( 쿠키 < 세션 )**
- **속도** **( 쿠키 > 세션 )**
- 쿠키는 쿠키에 정보가 있기 때문에 서버에 요청 시 응답만
- 세션은 정보가 서버에 있기 때문에 처리가 요구되어 비교적 느린 속도를 낸다.

보통 쿠키와 세션의 차이에 대해서 **저장 위치**와 **보안**에 대해서는 잘 알고 있지만, 중요한 것은 **라이프사이클**이다.

• 쿠키 : 만료시간에 따라 브라우저를 종료해도 계속해서 남아 있을 수 있다.

• 세션 : 만료시간을 정할 수 있지만 브라우저가 종료되면 만료시간에 상관없이 삭제된다.

---

**Q. 상황에 따라 어떤 방식을 사용할까?**

**쿠키**                                                                      

- 중요한 정보를 다루지 않을 때
- 서버의 자원 낭비를 방지할 때
- 속도 느려지는 것을 방지할 때

**세션**

- 사용자나 다른 누군가에게 노출되면 안되는 **중요한 정보를 다룰 때**에는 **세션**을 사용.

---

**캐시(Cache)**

> 이미지, 비디오, 오디오, css, js파일 등을 **미리 복사해 놓는** 리소스 파일들의 **임시 저장소**이다.
> 

웹 브라우저가 동일한 주소로 연속으로 요청할 경우 **첫 번째 요청의 결과를 로컬 PC의 캐시에 저장해둔 다음, 두 번째 요청 시 서버에 접근하는 것 대신에 로컬 PC의 캐시를 가져오는 방식**

- 데이터들이 빠르게 접근 가능(페이지의 로딩 속도 ↑)
- 같은 웹 페이지에 접속할 때 사용자의 PC에서 로드하므로 서버를 거치지 않아도 된다.
- 저장 공간이 작고 비용이 비싼 대신 빠른 성능을 제공한다.
